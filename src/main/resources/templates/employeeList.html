<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>직원 목록</title>
    <link rel="stylesheet" type="text/css" href="/liststyle.css">
</head>
<body>

<div class="sidebar">
    <h2>메뉴</h2>
    <ul>
<li><a href="#" onclick="toggleMenu(this)">인사관리</a>
            <ul class="open">
                <li><a href="#" onclick="toggleMenu(this)">직원 관리</a>
                    <ul class="open">
                        <li><a href="/employee/list">직원 목록</a></li>
                        <li><a href="/employee/new">직원 등록</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="toggleMenu(this)">인사 발령</a>
                    <ul class="open">
                        <li><a href="#">인사 발령 조회</a></li>
                        <li><a href="#">인사 발령 입력</a></li>
                        <li><a href="#">수정(삭제)</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="toggleMenu(this)">퇴사자 관리</a>
                    <ul class="open">
                        <li><a href="/manage/resignations">퇴사자 명단</a></li>
                        <li><a href="/resignation">퇴사 신청</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="toggleMenu(this)">증명서 관리</a>
                    <ul class="open">
                        <li><a href="#">재직 증명서</a></li>
                        <li><a href="#">경력 증명서</a></li>
                        <li><a href="#">급여 명세서</a></li>
                    </ul>
                </li>
            </ul>
        </li>
        <li><a href="#" onclick="toggleMenu(this)">근태 관리</a>
            <ul class="open">
                <li><a href="#" onclick="toggleMenu(this)">항목 코드 관리</a>
                    <ul class="open">
                        <li><a href="/">근태항목코드</a></li>
                        <li><a href="/">휴가항목코드</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="toggleMenu(this)">휴가</a>
                    <ul class="open">
                        <li><a href="/">휴가 신청</a></li>
                        <li><a href="/">휴가 신청자</a></li>
                        <li><a href="/">사원별 휴가 조회</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="toggleMenu(this)">출퇴근 관리</a>
                    <ul class="open">
                        <li><a href="/">출퇴근 기록 조회</a></li>
                        <li><a href="/">출퇴근 등록</a></li>
                    </ul>
                </li>
            </ul>
        </li>
        <li><a href="#" onclick="toggleMenu(this)">급여 관리</a>
            <ul class="open">
                <li><a href="#" onclick="toggleMenu(this)">급여 코드 관리</a>
                    <ul class="open">
                        <li><a href="/">수당 등록</a></li>
                        <li><a href="/">공제 등록</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="toggleMenu(this)">급여</a>
                    <ul class="open">
                        <li><a href="/">근무 기록 조회 및 확정</a></li>
                        <li><a href="/">급여 계산</a></li>
                        <li><a href="/">명세서 전송 및 조회</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="toggleMenu(this)">퇴직금</a>
                    <ul class="open">
                        <li><a href="/">퇴직금</a></li>
                    </ul>
                </li>
            </ul>
        </li>
        <li><a href="#" onclick="toggleMenu(this)">회사 관리</a>
            <ul class="open">
                <li><a href="#" onclick="toggleMenu(this)">회사</a>
                    <ul class="open">
                        <li><a href="/company/list">회사 정보/수정</a></li>
                        <li><a href="/company/new">회사 정보 등록</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="toggleMenu(this)">조직 개편</a>
                    <ul class="open">
                        <li><a href="/organization/position/list">직급 관리</a></li>
                        <li><a href="/organization/department/list">부서 관리</a></li>
                    </ul>
                </li>
            </ul>
        </li>

    </ul>
</div>
  
<div class="content">
    <button id="toggleSearch">검색</button>

    <div class="search-fields" id="searchFields">
        <form id="searchForm" action="/employee/search" method="get">
            <!-- 위치 1: 검색 필드 선택 -->
            <div class="search-field">
                <label for="searchField">선택:</label>
                <select id="searchField" name="searchField">
                    <option value="">선택하세요</option>
                    <option value="name">이름</option>
                    <option value="ssn">주민번호</option>
                    <option value="position">직급</option>
                    <option value="status">직원 구분</option>
                    <option value="department">부서</option>
                    <option value="hireDateStr">입사일</option>
                    <option value="contactInfo">연락처</option>
                    <option value="email">이메일</option>
                    <option value="birthDateStr">생년월일</option>
                    <option value="address">주소</option>
                    <option value="experience">경력</option>
                    <option value="accountNumber">계좌번호</option>
                    <option value="bank">은행</option>
                </select>
            </div>

            <!-- 위치 2: 동적으로 생성된 입력 필드 -->
            <div id="dynamicField" class="search-field">
                <!-- 동적으로 필드가 생성될 부분 -->
            </div>

            <button type="submit">검색</button>
        </form>
    </div>
</div>
<h1>직원 목록</h1>
<table>
    <tr>
        <th>ID</th>
        <th>사원번호</th>
        <th>이름</th>
        <th>주민번호</th>
        <th>직급</th>
        <th>직원 구분</th>
        <th>부서</th>
        <th>입사일</th>
        <th>연락처</th>
        <th>이메일</th>
        <th>생년월일</th>
        <th>주소</th>
        <th>경력</th>
        <th>계좌 번호</th>
        <th>은행</th>
    </tr>
    <tr th:each="employee : ${employees}">
        <td th:text="${employee.employeeId}"></td>
        <td th:text="${employee.employeeNumber}"></td>
        <!--<td th:text="${employee.name}"></td>-->
        <td><a th:href="@{/employee/{id}(id=${employee.employeeId})}" th:text="${employee.name}"></a></td>
        <td th:text="${employee.ssn}"></td>
        <td th:text="${employee.position.name}"></td>
        <td th:text="${employee.status}"></td>
        <td th:text="${employee.department.name}"></td>
        <td th:text="${employee.hireDate}"></td>
        <td th:text="${employee.contactInfo}"></td>
        <td th:text="${employee.email}"></td>
        <td th:text="${employee.birthDate}"></td>
        <td th:text="${employee.address}"></td>
        <td th:text="${employee.experience}"></td>
        <td th:text="${employee.accountNumber}"></td>
        <td th:text="${employee.bank}"></td>
    </tr>
</table>
<a href="/employee/new">직원 등록하기</a>
</div>
<script>
    document.getElementById('searchField').addEventListener('change', function() {
        var selectedField = this.value;
        var dynamicFieldDiv = document.getElementById('dynamicField');
        dynamicFieldDiv.innerHTML = ''; // 기존 필드 초기화

        if (selectedField === 'position' || selectedField === 'status' || selectedField === 'department') {
            var selectOptions = {
                'position': ['신입', '대리', '과장', '차장', '부장'],
                'status': ['정규', '계약', '퇴사'],
                'department': ['인사1팀', '인사2팀', '개발1팀', '개발2팀', '전산1팀', '고객관리팀', '국내영업팀', '총무팀', '경리팀']
            };

            var select = document.createElement('select');
            select.name = selectedField;
            select.id = selectedField;

            var option = document.createElement('option');
            option.value = '';
            option.textContent = '선택하세요';
            select.appendChild(option);

            selectOptions[selectedField].forEach(function(item) {
                var option = document.createElement('option');
                option.value = item;
                option.textContent = item;
                select.appendChild(option);
            });

            dynamicFieldDiv.appendChild(select);
        } else if (selectedField === 'hireDateStr' || selectedField === 'birthDateStr') {
            var input = document.createElement('input');
            input.type = 'date';
            input.name = selectedField;
            input.id = selectedField;
            dynamicFieldDiv.appendChild(input);
        } else if (selectedField !== '') {
            var input = document.createElement('input');
            input.type = 'text';
            input.name = selectedField;
            input.id = selectedField;
            input.placeholder = selectedField;
            dynamicFieldDiv.appendChild(input);
        }
    });
    document.getElementById('toggleSearch').addEventListener('click', function() {
    var searchFields = document.getElementById('searchFields');
    if (searchFields.style.display === 'none' || searchFields.style.display === '') {
        searchFields.style.display = 'block';  // 검색창을 표시
    } else {
        searchFields.style.display = 'none';  // 검색창을 숨김
    }
});
    function toggleMenu(element) {
    // 클릭한 요소의 상위 메뉴를 확인
    const parentMenu = element.closest('li').parentNode;

    // 상위 메뉴(인사관리, 근태관리, 급여관리, 회사관리)를 선택
    const allMainMenus = document.querySelectorAll('.sidebar > ul > li > a');

    // 하위 메뉴가 있는지 확인
    const nestedMenu = element.nextElementSibling;

    // 상위 메뉴 클릭 시, 다른 상위 메뉴의 하위 메뉴를 닫음
    if (parentMenu === document.querySelector('.sidebar > ul')) {
        allMainMenus.forEach(menu => {
            const siblingMenu = menu.nextElementSibling;
            if (siblingMenu && siblingMenu !== nestedMenu) {
                siblingMenu.classList.remove('active');
            }
        });
    }

    // 클릭된 메뉴의 하위 메뉴를 토글
    if (nestedMenu) {
        nestedMenu.classList.toggle('active');
    }
}
</script>
</body>
</html>
